{% load static %}
{% load crispy_forms_tags %}
{% load widget_tweaks %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>StrangeFlix</title>
    <!-- font-awesome  -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link rel="stylesheet" href="{% static "css/fontawesome.min.css" %}"> -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>
    <!-- google-fonts -->
    <link href="https://fonts.googleapis.com/css?family=Cinzel+Decorative:900|IBM+Plex+Sans&display=swap"
        rel="stylesheet">

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="{% static "css/bootstrap.min.css" %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
        integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- css  -->
    <link rel="stylesheet" href="{% static "css/homes.css" %}">
</head>

<body>
    <div class="navbar-section">
        <nav class="navbar navbar-expand-md navbar-dark bg-dark sticky-top">
            <a href="#" class="navbar-brand py-3 font-weight-bold">Strangeflix</a>
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav">
                    <li class="nav-item active"><a class="nav-link" href="#">Home</a></li>
                    <li class="nav-item">
                        <!-- <a class="nav-link" href="#"> -->
                        <div class="dropdown py-2 px-2 specia-drop">
                            <button class="rem-button" id="dropdownMenu2" aria-haspopup="true" aria-expanded="false">
                                Sports
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                                <div class="dropdown-item">
                                    <a href="#">Cricket</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Football</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Tennis</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Martial Arts</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">eSports</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Hockey</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Badminton</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Wrestling</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Kabbadi</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Table Tennis</a>
                                </div>
                            </div>
                        </div>
                        <!-- </a> -->
                    </li>
                    <li class="nav-item">
                        <div class="dropdown py-2 px-2 specia-drop">
                            <button class="rem-button" id="dropdownMenu3" aria-haspopup="true" aria-expanded="false">
                                Entertainment
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenu3">
                                <div class="dropdown-item">
                                    <a href="#">Action</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Adventure</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Animation</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Comedy</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Crime</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Drama</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Horror</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Romance</a>
                                </div>
                                <div class="dropdown-item">
                                    <a href="#">Thriller</a>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
                <div class="navbar-nav ml-auto">

                    <!-- search bar  -->
                    <input type="text" id="sear" class="form-control mr-sm-2" placeholder="search by name">
                    <div class="btn-group">
                        <button type="submit" class="btn btn-dark">Search</button>
                        <button type="button" class="btn btn-danger dropdown-toggle dropdown-toggle-split"
                            aria-haspopup="true" aria-expanded="false">
                        </button>
                        <div class="dropdown-menu">
                            <button id="sear-by-nam" class="dropdown-item btn-secondary">Search by name</a>
                                <button id="sear-by-tag" class="dropdown-item btn-secondary">Search by tags</a>
                        </div>
                    </div>

                    {% if user.is_authenticated %}
                    <li class="mx-4">
                        <div class="btn-group specia-drop">
                            <button class="rem-button py-2 px-2" aria-haspopup="true" aria-expanded="false">
                                {{ user.username }}
                            </button>
                            <div class="dropdown-menu dropdown-menu-right">
                                <a class="dropdown-item" href="#">Profile</a>
                                <a class="dropdown-item" href="{% url "subscription_plans" %}">Subscribe</a>
                                <a class="dropdown-item" href="{% url "wallet_details" %}">Wallet</a>
                                <a class="dropdown-item" href="#">Create Room</a>
                                <a class="dropdown-item" href="#">Join Room</a>
                                <a class="dropdown-item" href="{% url "account_logout" %}">Logout</a>
                            </div>
                        </div>
                    </li>
                    {% else %}
                    <li class="mx-4">
                        <!-- login  -->
                        <a href="#" class="nav-item nav-link ml-2" data-toggle="modal"
                            data-target="#loginModal">Login</a>
                    </li>
                    {% endif %}
                </div>
            </div>
        </nav>
        <!-- login modal  -->
        <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true" style="color: black;">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header border-bottom-0">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-title text-center">
                            <h4>Login</h4>
                        </div>
                        <div>
                            <a href="{% url 'social:begin' 'facebook' %}" class="btn btn-block btn-social btn-facebook"
                                style="text-align:center;color: white;background: #3b5998;">
                                <!-- <span class="fa fa-facebook"></span> -->
                                <svg aria-hidden="true" class="svg-icon iconFacebook" width="20" height="20"
                                    viewBox="0 0 18 18">
                                    <path
                                        d="M3 1a2 2 0 00-2 2v12c0 1.1.9 2 2 2h12a2 2 0 002-2V3a2 2 0 00-2-2H3zm6.55 16v-6.2H7.46V8.4h2.09V6.61c0-2.07 1.26-3.2 3.1-3.2.88 0 1.64.07 1.87.1v2.16h-1.29c-1 0-1.19.48-1.19 1.18V8.4h2.39l-.31 2.42h-2.08V17h-2.5z"
                                        fill="#ffffff"></path>
                                </svg>
                                Sign in with Facebook
                            </a>
                            <a href="{% url 'social:begin' 'google-oauth2' %}"
                                class="btn btn-block btn-social btn-facebook"
                                style="background-color:#ebecf5;text-align:center">
                                <!-- <span class="fa fa-facebook"></span> -->
                                <svg aria-hidden="true" class="native svg-icon iconGoogle" width="20" height="20"
                                    viewBox="0 0 18 18">
                                    <path
                                        d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 002.38-5.88c0-.57-.05-.66-.15-1.18z"
                                        fill="#4285F4"></path>
                                    <path
                                        d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2a4.8 4.8 0 01-7.18-2.54H1.83v2.07A8 8 0 008.98 17z"
                                        fill="#34A853"></path>
                                    <path d="M4.5 10.52a4.8 4.8 0 010-3.04V5.41H1.83a8 8 0 000 7.18l2.67-2.07z"
                                        fill="#FBBC05"></path>
                                    <path
                                        d="M8.98 4.18c1.17 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 001.83 5.4L4.5 7.49a4.77 4.77 0 014.48-3.3z"
                                        fill="#EA4335"></path>
                                </svg>
                                Sign in with Google
                            </a>
                        </div>
                        <div class="d-flex flex-column mx-5">
                            <form id="loginform">
                                {% csrf_token %}
                                <div class="form-group my-4">
                                    {{ login_form.username|add_class:"form-control"|as_crispy_field }}
                                </div>
                                <div class="form-group my-4">
                                    {{ login_form.password|add_class:"form-control"|as_crispy_field }}
                                </div>
                                <div class="text-center my-4">
                                    <button onclick="custom_login()" type="button"
                                        class="btn btn-info btn-round">Login</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="modal-footer d-flex justify-content-center">
                        <div class="signup-section">Not a member yet? <a href="#a" id="signup" class="text-info"
                                data-toggle="modal" data-target="#signupModal"> Sign Up</a>.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- signup modal  -->
        <div class="modal fade" id="signupModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
            aria-hidden="true" style="color: black;">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header border-bottom-0">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-title text-center">
                            <h4>Register</h4>
                        </div>
                        <div class="d-flex flex-column mx-5">
                            <form method="POST" action="/accounts/register/">
                                {% csrf_token %}
                                <div class="form-group my-4">
                                    {{ registration_form.username|add_class:"form-control"|as_crispy_field }}
                                </div>
                                <div class="form-group my-4">
                                    {{ registration_form.email|add_class:"form-control"|as_crispy_field }}
                                </div>
                                <div class="form-group my-4">
                                    {{ registration_form.password1|add_class:"form-control"|as_crispy_field }}
                                </div>
                                <div class="form-group my-4">
                                    {{ registration_form.password2|add_class:"form-control"|as_crispy_field }}
                                </div>
                                <div class="text-center">
                                    <button type="submit" class="btn btn-info btn-round">Register</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="modal-footer d-flex justify-content-center">
                        <div class="signup-section">Already a member? <a href="#a" id="login" class="text-info"
                                data-toggle="modal" data-target="#loginModal">Login</a>.</div>
                    </div>
                </div>
            </div>
        </div>


        <!-- if not logged in  -->
        <div class="n-l-section">

        </div>

    </div>
    <div id="video_with_comments">

    </div>
    <div id="selected_series">
        <p id="selected_series_id" hidden></p>
        <p id="selected_series_season_id" hidden></p>
        <div id="selected_season_description">

        </div>
        <div id="selected_season_freecontent">

        </div>
        <div id="selected_season_episodes">

        </div>
        <div id="selected_series_description">

        </div>
        <div id="selected_series_season">

        </div>
    </div>
    <div id="selected_movie">
        <p id="selected_movie_id" hidden></p>
        <div id="selected_movie_description">

        </div>
        <div id="selected_movie_freecontent">

        </div>
    </div>
    {% include "home/recommen.html" %}
    <!-- movie rating modal  -->
    <div class="modal fade" id="movierateCenter" tabindex="-1" role="dialog" aria-labelledby="rate-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="movierate-title" style="color: white;">Rate</h5>
                    <button type="button" id="moviereset-rating" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body my-3 mx-3">
                    <div class="rating-taker">
                        <span class="px-3" style="color: white;">Rating</span>
                        <span class="px-1 movierating-val" value="1">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 movierating-val" value="2">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 movierating-val" value="3">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 movierating-val" value="4">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 movierating-val" value="5">
                            <i class="fas fa-star"></i>
                        </span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" id="movierate-submit">Submit</button>
                </div>
            </div>
        </div>
    </div>
    <!-- series rating modal  -->
    <div class="modal fade" id="seriesrateCenter" tabindex="-1" role="dialog" aria-labelledby="rate-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content bg-dark">
                <div class="modal-header">
                    <h5 class="modal-title" id="seriesrate-title" style="color: white;">Rate</h5>
                    <button type="button" id="seriesreset-rating" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body my-3 mx-3">
                    <div class="rating-taker">
                        <span class="px-3" style="color: white;">Rating</span>
                        <span class="px-1 seriesrating-val" value="1">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 seriesrating-val" value="2">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 seriesrating-val" value="3">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 seriesrating-val" value="4">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="px-1 seriesrating-val" value="5">
                            <i class="fas fa-star"></i>
                        </span>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger btn-sm" id="seriesrate-submit">Submit</button>
                </div>
            </div>
        </div>
    </div>
    <!-- jQuery CDN - Slim version (=without AJAX) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
    </script>
    <script src="{% static "/js/jquery-3.5.1.js" %}"></script>

    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
        integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous">
    </script>
    <!-- Bootstrap JS -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
    </script>
    <script src="{% static "/js/homes.js" %}"></script>
    <script src="{% static "/js/index.js" %}"></script>
    <!-- <script src="{% static "/js/videoplayer.js" %}"></script> -->


    <!-- to truncate the extra hash in url -->
    <script type="text/javascript">
        if (window.location.hash === "#_=_") {
            history.replaceState ?
                history.replaceState(null, null, window.location.href.split("#")[0]) :
                window.location.hash = "";
        }
    </script>

    <script>
        function custom_login() {

            var username = document.querySelector("#loginform #id_username").value;
            var password = document.querySelector("#loginform #id_password").value;

            // javascript data object
            var data = {
                'username': username,
                'password': password,
            }

            // adding data to javascript form which is to be send over ajax request
            var formData = new FormData();
            formData.append('data', JSON.stringify(data));

            $.ajax({
                type: 'POST',
                url: '{% url "account_login" %}',
                data: formData,
                dataType: 'json',
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                success: function (data) {
                    // checking and handling error conditions
                    if (data.is_username_exists != '') {
                        alert(data.is_username_exists);
                    } else if (data.is_password_matches != '') {
                        alert(data.is_password_matches);
                    } else if (data.is_successful != '') {
                        window.location.href = data.redirect_url;
                    } else {
                        alert('Some unexpected error has occured. Try again.');
                    }
                }
            });
        }


        function open_movie(movie_id) {
            // javascript data object
            var data = {
                'movie_id': movie_id
            }

            // adding data to javascript form which is to be send over ajax request
            var formData = new FormData();
            formData.append('data', JSON.stringify(data));

            $.ajax({
                type: 'POST',
                url: '{% url "get_movie_details" %}',
                data: formData,
                dataType: 'json',
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                success: function (data) {
                    // checking and handling error conditions
                    if (data.is_movie_exists != '') {
                        alert(data.is_movie_exists);
                    } else if (data.is_successful != '') {
                        $("#selected_movie_description").empty();
                        $("#selected_movie_freecontent").empty();

                        set_content_display('none', 'none', 'none', 'none', 'none', 'none', 'block', 'block');

                        document.getElementById('selected_movie_id').innerHTML = movie_id;

                        for (var key in data.movie_content_data) {
                            var htmlgen = '<div id="movie_'+ movie_id +'" class="series-view-section container-fluid"><div class="row lin-grade"><div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3"><div class="info-sect mx-4"><div class="series-naam py-4"><h4 class="font-weight-bold">'+ data.movie_content_data[key][1] +'</h4><div class="class-muted"><p class="text-muted">';

                            for (var i = 0; i < data.movie_content_data[key][9].length; i++) {
                                htmlgen += data.movie_content_data[key][9][i] + ' | ';
                            }

                            htmlgen += '</p><p class="text-muted">';

                            for (var i = 0; i < data.movie_content_data[key][8].length; i++) {
                                htmlgen += data.movie_content_data[key][8][i] + ' | ';
                            }

                            htmlgen += '</p><p class="text-muted">'+ data.movie_content_data[key][10] +'</p></div><div class="ser-describ">'+ data.movie_content_data[key][2] +'</div></div></div><button type="button" onclick="play_movie('+ data.movie_content_data[key][0] +')" class="vid-dislike mx-4 mr-auto" title="play"><span class="ico-cont bg-danger text-center py-1 px-2"><span class="py-3"><i class="fas fa-play"></i></span></span><p class="add-to-rate py-3">Play</p></button><button type="button" class="vid-dislike mx-2 mr-auto" title="Dislike" data-toggle="modal" data-target="#movierateCenter"><span class="ico-cont bg-danger text-center py-1 px-1"><span class="py-3"><i class="fas fa-star"></i></span></span><p class="add-to-rate py-3">Rate</p></button></div><div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9"><div class="ser-tp-tmb"><img class="img-fluid ser-tmb-img" src="'+ data.movie_content_data[key][3] +'"alt="image4"></div></div></div></div>';
                            var freecontent = '<div class="show-up"><div id="movie_content_'+ movie_id +'" class="free-description-section"><div class="container-fluid my-5"><h3 class="font-weight-bold mx-5 px-4">Trailers and Clips<i class="arrow right mx-1"></i></h4><div id="movie_freecontent-controls" class="carousel slide" data-ride="carousel" data-interval="false" data-wrap="false"><div class="carousel-inner"><div class="carousel-item active mx-5"><div class="row">';

                            var count = 0;
                            for (var val in data.movie_free_data) {
                                count++;
                                if (count != 1 && (count-1)%6 == 0) {
                                    freecontent += '<div class="carousel-item"><div class="row">';
                                }
                                freecontent += '<div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-xs-2 spec-card"><div class="card py-3 px-3" style="border:0"><div class="card-body"><div class="ser-name-carouse text-center font-weight-bold">'+ data.movie_free_data[val][1] +'</div><div class="img-seci"><a href="#" onclick="play_free_movie('+ data.movie_free_data[val][0] +')"><img class="img-fluid ser-img" src="'+ data.movie_free_data[val][3] +'" alt="image4"></a></div></div></div></div>';

                                if (count%6 == 0) {
                                    freecontent += '</div></div>';
                                }
                            }
                            if (Object.keys(data.movie_free_data).length%6 != 0) {
                                freecontent += '</div></div>';
                            }
                            freecontent += '</div><a class="carousel-control-prev bg-danger" href="#movie_freecontent-controls" role="button" data-slide="prev"style="display:none"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control-next bg-danger" href="#movie_freecontent-controls" role="button" data-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a></div></div></div></div>';

                        }

                        $("#selected_movie_description").append(htmlgen);
                        $("#selected_movie_freecontent").append(freecontent);
                        if ($('#movie_freecontent-controls .carousel-inner .carousel-item:first').hasClass('active')) {
                            $('#movie_freecontent-controls').children('#movie_freecontent-controls .carousel-control-prev').hide();
                        }
                        if ($('#movie_freecontent-controls .carousel-inner .carousel-item:last').hasClass('active')) {
                            $('#movie_freecontent-controls').children('#movie_freecontent-controls .carousel-control-next').hide();
                        }

                    } else {
                        alert('Some unexpected error has occured. Try again.');
                    }
                }
            });
        }


        function open_series(series_id) {
            // javascript data object
            var data = {
                'series_id': series_id
            }

            // adding data to javascript form which is to be send over ajax request
            var formData = new FormData();
            formData.append('data', JSON.stringify(data));

            $.ajax({
                type: 'POST',
                url: '{% url "get_series_details" %}',
                data: formData,
                dataType: 'json',
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                success: function (data) {
                    // checking and handling error conditions
                    if (data.is_series_exists != '') {
                        alert(data.is_series_exists);
                    } else if (data.is_successful != '') {
                        $("#selected_series_description").empty();
                        $("#selected_series_season").empty();

                        set_content_display('none', 'none', 'none', 'none', 'block', 'block', 'none', 'none');

                        document.getElementById('selected_series_id').innerHTML = series_id;
                        for (var key in data.series_content_data) {
                            var htmlgen = '<div id="series_'+ key +'" class="series-view-section container-fluid"><div class="row lin-grade"><div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3"><div class="info-sect mx-4"><div class="series-naam py-4"><h4 class="font-weight-bold">'+ data.series_content_data[key][0] +'</h4><div class="class-muted"><p class="text-muted">'+ data.series_content_data[key][3] + ' | ';

                            for (var i = 0; i < data.series_content_data[key][5].length; i++) {
                                htmlgen += data.series_content_data[key][5][i] + ' | ';
                            }

                            htmlgen += '</p></div><div class="ser-describ">'+ data.series_content_data[key][1] +'</div></div></div><button type="button" class="vid-dislike mx-2 mr-auto" title="Dislike" data-toggle="modal" data-target="#seriesrateCenter"><span class="ico-cont bg-danger text-center py-1 px-1"><span class="py-3"><i class="fas fa-star"></i></span></span><p class="add-to-rate py-3">Rate</p></button></div><div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9"><div class="ser-tp-tmb"><img class="img-fluid ser-tmb-img" src="'+ data.series_content_data[key][4] +'"alt="image4"></div></div></div></div>';
                            var seasons = '<div class="show-up"><div id="series_season_'+ key +'" class="free-description-section"><div class="container-fluid my-5"><h3 class="font-weight-bold mx-5 px-4">Seasons<i class="arrow right mx-1"></i></h4><div id="series_season-controls" class="carousel slide" data-ride="carousel" data-interval="false" data-wrap="false"><div class="carousel-inner"><div class="carousel-item active mx-5"><div class="row">';
                            var count = 0;
                            for (var val in data.series_season_data) {
                                count++;
                                if (count != 1 && (count-1)%6 == 0) {
                                    seasons += '<div class="carousel-item"><div class="row">';
                                }
                                seasons += '<div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-xs-2 spec-card"><div class="card py-3 px-3" style="border:0"><div class="card-body"><div class="ser-name-carouse text-center font-weight-bold">Season '+ data.series_season_data[val][1] +'</div><div class="img-seci"><a href="#" onclick="open_season('+ val +')"><img class="img-fluid ser-img" src="'+ data.series_season_data[val][5] +'" alt="image4"></a></div></div></div></div>';

                                if (count%6 == 0) {
                                    seasons += '</div></div>';
                                }
                            }
                            if (Object.keys(data.series_season_data).length%6 != 0) {
                                seasons += '</div></div>';
                            }
                            seasons += '</div><a class="carousel-control-prev bg-danger" href="#series_season-controls" role="button" data-slide="prev"style="display:none"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control-next bg-danger" href="#series_season-controls" role="button" data-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a></div></div></div></div>';

                        }
                        $("#selected_series_description").append(htmlgen);
                        $("#selected_series_season").append(seasons);

                        if ($('#series_season-controls .carousel-inner .carousel-item:first').hasClass('active')) {
                            $('#series_season-controls').children('#series_season-controls .carousel-control-prev').hide();
                        }
                        if ($('#series_season-controls .carousel-inner .carousel-item:last').hasClass('active')) {
                            $('#series_season-controls').children('#series_season-controls .carousel-control-next').hide();
                        }

                    } else {
                        alert('Some unexpected error has occured. Try again.');
                    }
                }
            });
        }


        function open_season(series_season_id) {
            // javascript data object
            var data = {
                'series_season_id': series_season_id
            }

            // adding data to javascript form which is to be send over ajax request
            var formData = new FormData();
            formData.append('data', JSON.stringify(data));

            $.ajax({
                type: 'POST',
                url: '{% url "get_season_details" %}',
                data: formData,
                dataType: 'json',
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                success: function (data) {
                    // checking and handling error conditions
                    if (data.is_season_exists != '') {
                        alert(data.is_season_exists);
                    } else if (data.is_successful != '') {
                        $("#selected_season_description").empty();
                        $("#selected_season_freecontent").empty();
                        $("#selected_season_episodes").empty();

                        document.getElementById('selected_series_season_id').innerHTML = series_season_id;

                        for (var key in data.season_content_data) {
                            var htmlgen = '<div id="series_season_'+ key +'" class="series-view-section container-fluid"><div class="row lin-grade"><div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-xs-3"><div class="info-sect mx-4"><div class="series-naam py-4"><h4 class="font-weight-bold">Season '+ data.season_content_data[key][0] +'</h4><div class="class-muted"><p class="text-muted">'+ data.season_content_data[key][3] + ' | ';

                            for (var i = 0; i < data.season_content_data[key][5].length; i++) {
                                htmlgen += data.season_content_data[key][5][i] + ' | ';
                            }

                            htmlgen += '</p></div><div class="ser-describ">'+ data.season_content_data[key][1] +'</div></div></div></div><div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-xs-9"><div class="ser-tp-tmb"><img class="img-fluid ser-tmb-img" src="'+ data.season_content_data[key][4] +'"alt="image4"></div></div></div></div>';

                            var freecontent = '<div class="show-up"><div id="series_season_content_'+ key +'" class="free-description-section"><div class="container-fluid my-5"><h3 class="font-weight-bold mx-5 px-4">Trailers and Clips<i class="arrow right mx-1"></i></h4><div id="series_season_freecontent-controls" class="carousel slide" data-ride="carousel" data-interval="false" data-wrap="false"><div class="carousel-inner"><div class="carousel-item active mx-5"><div class="row">';

                            var count = 0;
                            for (var val in data.season_free_data) {
                                count++;
                                if (count != 1 && (count-1)%6 == 0) {
                                    freecontent += '<div class="carousel-item"><div class="row">';
                                }
                                freecontent += '<div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-xs-2 spec-card"><div class="card py-3 px-3" style="border:0"><div class="card-body"><div class="ser-name-carouse text-center font-weight-bold">'+ data.season_free_data[val][1] +'</div><div class="img-seci"><a href="#" onclick="play_free_episode('+ data.season_free_data[val][0] +')"><img class="img-fluid ser-img" src="'+ data.season_free_data[val][3] +'" alt="image4"></a></div></div></div></div>';

                                if (count%6 == 0) {
                                    freecontent += '</div></div>';
                                }
                            }
                            if (Object.keys(data.season_free_data).length%6 != 0) {
                                freecontent += '</div></div>';
                            }
                            freecontent += '</div><a class="carousel-control-prev bg-danger" href="#series_season_freecontent-controls" role="button" data-slide="prev"style="display:none"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control-next bg-danger" href="#series_season_freecontent-controls" role="button" data-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a></div></div></div></div>';

                            var episodes = '<div class="show-up"><div id="series_episode_'+ key +'" class="free-description-section"><div class="container-fluid my-5"><h3 class="font-weight-bold mx-5 px-4">Episodes<i class="arrow right mx-1"></i></h4><div id="series_season_episodes-controls" class="carousel slide" data-ride="carousel" data-interval="false" data-wrap="false"><div class="carousel-inner"><div class="carousel-item active mx-5"><div class="row">';

                            count = 0;
                            for (var val in data.season_episodes) {
                                count++;
                                if (count != 1 && (count-1)%6 == 0) {
                                    episodes += '<div class="carousel-item"><div class="row">';
                                }
                                episodes += '<div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 col-xs-2 spec-card"><div class="card py-3 px-3" style="border:0"><div class="card-body"><div class="ser-name-carouse text-center font-weight-bold">Episode '+ val +' - '+ data.season_episodes[val][1] +'</div><div class="img-seci"><a href="#" onclick="play_episode('+ data.season_episodes[val][0] +')"><img class="img-fluid ser-img" src="'+ data.season_episodes[val][3] +'" alt="image4"></a></div></div></div></div>';

                                if (count%6 == 0) {
                                    episodes += '</div></div>';
                                }
                            }
                            if (Object.keys(data.season_episodes).length%6 != 0) {
                                episodes += '</div></div>';
                            }
                            episodes += '</div><a class="carousel-control-prev bg-danger" href="#series_season_episodes-controls" role="button" data-slide="prev"style="display:none"><span class="carousel-control-prev-icon" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control-next bg-danger" href="#series_season_episodes-controls" role="button" data-slide="next"><span class="carousel-control-next-icon" aria-hidden="true"></span><span class="sr-only">Next</span></a></div></div></div></div>';

                        }

                        $("#selected_season_description").append(htmlgen);
                        $("#selected_season_freecontent").append(freecontent);
                        $("#selected_season_episodes").append(episodes);

                        set_content_display('none', 'block', 'block', 'block', 'none', 'block', 'none', 'none');

                        if ($('#series_season_freecontent-controls .carousel-inner .carousel-item:first').hasClass('active')) {
                            $('#series_season_freecontent-controls').children('#series_season_freecontent-controls .carousel-control-prev').hide();
                        }
                        if ($('#series_season_freecontent-controls .carousel-inner .carousel-item:last').hasClass('active')) {
                            $('#series_season_freecontent-controls').children('#series_season_freecontent-controls .carousel-control-next').hide();
                        }

                        if ($('#series_season_episodes-controls .carousel-inner .carousel-item:first').hasClass('active')) {
                            $('#series_season_episodes-controls').children('#series_season_episodes-controls .carousel-control-prev').hide();
                        }
                        if ($('#series_season_episodes-controls .carousel-inner .carousel-item:last').hasClass('active')) {
                            $('#series_season_episodes-controls').children('#series_season_episodes-controls .carousel-control-next').hide();
                        }

                    } else {
                        alert('Some unexpected error has occured. Try again.');
                    }
                }
            });
        }


        function play_movie(video_id) {

            var playerhtml = '<!-- video running section  --><div class="runner-section container-fluid"><div class="row"><!-- video-player  --><div class="col-xl-9 col-lg-8 col-md-7 player-wrapper"><!-- if paid  --><div class="player" id="movie-video-player"><!-- video-head  --><div class="video-head"><div class="text-white"><h3 class="font-weight-bold">movie name</h4></div></div><!-- video-body  --><div class="video-body"><video class="player__video viewer" id="movie-video" preload="metadata"><source src="" id="movie-insert-vid" type="video/mp4"></video></div><!-- video-footer  --><div class="video-footer"><div class="player__controls" id="movie-plact"><!-- progress-bar  --><div class="progress"><div class="progress__filled"></div></div><!-- play/pause  --><button class="player__button toggle" data-toggle="tooltip" title="pause"><i id="movie-play-icon" class="fas fa-play"></i></button><!-- skip 10s backword --><button data-skip="-10" class="backword__button" data-toggle="tooltip" title="Skip -10s">«10s</button><!-- skip 10s forward --><button data-skip="10" class="forward__button" data-toggle="tooltip" title="Skip 10s">10s»</button><!-- volume  --><button class="volume__button" data-toggle="tooltip" title="mute" id="movie-volume"><i id="movie-vol-ico" class="fas fa-volume-up"></i></button><input type="range" name="volume" id="movie-vol-ran" class="player__slider" min="0" max="1" step="0.05" value="1"><!-- video timer  --><button id="movie-progressTime" class="timer__button"><span id="movie-current">00:00 / </span><span id="movie-duration">00:00</span></button><!-- playbackrate  --><!-- <input type="range" name="playbackRate" class="player__slider" min="0.5" max="2" step="0.1" value="1"> --><div class="fullscreen"><!-- setting  --><!-- <button id="movie-setting" class="setting__button" data-toggle="tooltip" title="setting"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button> --><button type="button" class="prev-button mr-3"><i class="fas fa-step-backward"></i></button><button type="button" class="next-button"><i class="fas fa-step-forward"></i></button><div class="btn-group dropup"><button id="movie-setting" class="setting__button" data-toggle="dropdown" aria-haspopup="true"aria-expanded="false"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button><div class="dropdown-menu plbcrt"><a href="#" class="dropdown-item playbacki dis">Playback speed</a><a href="#" class="dropdown-item quali dis">Video Quality</a><a href="#" class="dropdown-item shortcuts dis">Keyboard shortcuts</a><a href="#" class="dropdown-item playback">0.25</a><a href="#" class="dropdown-item playback">0.5</a><a href="#" class="dropdown-item playback">1</a><a href="#" class="dropdown-item playback">1.25</a><a href="#" class="dropdown-item playback">1.5</a><a href="#" class="dropdown-item playback">1.75</a><a href="#" class="dropdown-item playback">2</a><a href="#" class="dropdown-item qual">Auto</a><a href="#" class="dropdown-item qual">480p</a><a href="#" class="dropdown-item qual">720p</a><a href="#" class="dropdown-item qual">1080p</a></div></div><!-- picture-in-picture  --><button id="movie-pip" class="pip__button" data-toggle="tooltip" title="picture-in-picture"><span class="px-4"><i id="movie-pip-ico" class="fas fa-window-maximize"></i></span></button><!-- theatre view  --><button class="theatre__button" data-toggle="tooltip" title="theatre mode"><span class="px-4"><i id="movie-th-ico" class="fas fa-arrows-alt-v"></i></span></button><!-- fullscreen  --><button id="movie-fs" class="fs__button" data-toggle="tooltip" title="fullscreen"><span class="px-4"><i id="movie-fs-ico" class="fas fa-expand"></i></span></button></div></div></div></div><!-- else this  --><!-- pay cost per video  --><div class="text-center text-muted text-white">pay $(number) to watch this video <button class="btn btn-primary btn-sm" type="button">Pay</button></div></div><!-- sidebar content  --><div class="col-xl-3 col-lg-6 col-md-5"><div style="background-color: white;color: black;" class="card comment"><div class="card-header"><h4>Comments</h4></div><div class="card-body"><ul id="movie-vid-comments"><li><div class="row media"><div class="col-xl-2 col-lg-2 col-md-2 col-sm-2"><!-- user-profile  --><img src="/img/img1.png" alt="" class="img-fluid"></div><!-- video-desccription  --><div class="col-xl-10 col-lg-10 col-md-10 col-sm-10"><div class="media-body px-1"><span class="font-weight-bold">S1 E1 - date</span><div class="d-cent text-justify">Lorem ipsum dolor sit amet consectetur adipisicing elit.Distinctio doloribus explicabo enim quae tenetur omnis, optiodolorem et. Eaque similique obcaecati laborum blanditiis officiis veniam maxime veritatis alias inventore voluptates!</div><button type="button" class="flg-comm-button px-2" data-toggle="modal" data-target="#flagCommentCenter"><i class="fas fa-flag"></i></button><button type="button" class="show-mr-button">show</button></div></div></div></li></ul></div></div></div></div></div>';

            $("#video_with_comments").empty();
            $("#video_with_comments").append(playerhtml);
            initialize_movie_player();

            set_content_display('block', 'none', 'none', 'none', 'none', 'none', 'none', 'block');

            var video = document.querySelector('#movie-video');
            var video_url = window.location.origin + '/video/' + video_id;
            var playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Automatic playback started!
                    // Show playing UI.
                })
                .catch(error => {
                    // Auto-play was prevented
                    // Show paused UI.
                });
            }
            $('#movie-insert-vid').attr('src', video_url);
            $('.progress__filled').css('flex', '0');

            // javascript data object
            // var data = {
            //     'movie_id': movie_id,
            //     'start_time':  video.currentTime,
            // }

            // // adding data to javascript form which is to be send over ajax request
            // var formData = new FormData();
            // formData.append('data', JSON.stringify(data));

            // $.ajax({
            //     type: 'POST',
            //     url: '',
            //     data: formData,
            //     dataType: 'json',
            //     enctype: 'multipart/form-data',
            //     processData: false,
            //     contentType: false,
            //     success: function (data) {
            //         // checking and handling error conditions
            //         if (data.is_movie_exists != '') {
            //             alert(data.is_movie_exists);
            //         } else if (data.is_user_subscribed != '') {
            //             alert(data.is_user_subscribed);
            //         } else if (data.is_successful != '') {
            //             console.log('called');
            //             var byteCharacters = atob(data.stream);
            //             var byteNumbers = new Array(byteCharacters.length);
            //             for (let i = 0; i < byteCharacters.length; i++) {
            //                 byteNumbers[i] = byteCharacters.charCodeAt(i);
            //             }

                        // // Show loading animation.
                        // var playPromise = video.play();

                        // if (playPromise !== undefined) {
                        //     playPromise.then(_ => {
                        //         // Automatic playback started!
                        //         // Show playing UI.
                        //     })
                        //     .catch(error => {
                        //         // Auto-play was prevented
                        //         // Show paused UI.
                        //     });
                        // }
            //             movie_total_duration = data.movie_duration
            //             var blobArray = [];
            //             blobArray.push(new Blob([new Uint8Array(byteNumbers)],{'type':'video/mp4'}));
            //             var currentTime = video.currentTime;
            //             var blob = new Blob(blobArray,{'type':'video/mp4'});
            //             video.src = window.URL.createObjectURL(blob);
            //             video.currentTime = currentTime;
            //             movie_previous_time_watched = 0;     // if using history add history time
            //             movie_maxtime_fetched = Math.min(currentTime + 10, movie_total_duration);
            //             $('.progress__filled').css('flex', '0');
            //             video.play();

            //         } else {
            //             alert('Some unexpected error has occured. Try again.');
            //         }
            //     }
            // });
        }


        function play_episode(video_id) {

            var playerhtml = '<!-- video running section  --><div class="runner-section container-fluid"><div class="row"><!-- video-player  --><div class="col-xl-9 col-lg-8 col-md-7 player-wrapper"><!-- if paid  --><div class="player" id="movie-video-player"><!-- video-head  --><div class="video-head"><div class="text-white"><h3 class="font-weight-bold">movie name</h4></div></div><!-- video-body  --><div class="video-body"><video class="player__video viewer" id="movie-video" preload="metadata"><source src="" id="movie-insert-vid" type="video/mp4"></video></div><!-- video-footer  --><div class="video-footer"><div class="player__controls" id="movie-plact"><!-- progress-bar  --><div class="progress"><div class="progress__filled"></div></div><!-- play/pause  --><button class="player__button toggle" data-toggle="tooltip" title="pause"><i id="movie-play-icon" class="fas fa-play"></i></button><!-- skip 10s backword --><button data-skip="-10" class="backword__button" data-toggle="tooltip" title="Skip -10s">«10s</button><!-- skip 10s forward --><button data-skip="10" class="forward__button" data-toggle="tooltip" title="Skip 10s">10s»</button><!-- volume  --><button class="volume__button" data-toggle="tooltip" title="mute" id="movie-volume"><i id="movie-vol-ico" class="fas fa-volume-up"></i></button><input type="range" name="volume" id="movie-vol-ran" class="player__slider" min="0" max="1" step="0.05" value="1"><!-- video timer  --><button id="movie-progressTime" class="timer__button"><span id="movie-current">00:00 / </span><span id="movie-duration">00:00</span></button><!-- playbackrate  --><!-- <input type="range" name="playbackRate" class="player__slider" min="0.5" max="2" step="0.1" value="1"> --><div class="fullscreen"><!-- setting  --><!-- <button id="movie-setting" class="setting__button" data-toggle="tooltip" title="setting"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button> --><button type="button" class="prev-button mr-3"><i class="fas fa-step-backward"></i></button><button type="button" class="next-button"><i class="fas fa-step-forward"></i></button><div class="btn-group dropup"><button id="movie-setting" class="setting__button" data-toggle="dropdown" aria-haspopup="true"aria-expanded="false"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button><div class="dropdown-menu plbcrt"><a href="#" class="dropdown-item playbacki dis">Playback speed</a><a href="#" class="dropdown-item quali dis">Video Quality</a><a href="#" class="dropdown-item shortcuts dis">Keyboard shortcuts</a><a href="#" class="dropdown-item playback">0.25</a><a href="#" class="dropdown-item playback">0.5</a><a href="#" class="dropdown-item playback">1</a><a href="#" class="dropdown-item playback">1.25</a><a href="#" class="dropdown-item playback">1.5</a><a href="#" class="dropdown-item playback">1.75</a><a href="#" class="dropdown-item playback">2</a><a href="#" class="dropdown-item qual">Auto</a><a href="#" class="dropdown-item qual">480p</a><a href="#" class="dropdown-item qual">720p</a><a href="#" class="dropdown-item qual">1080p</a></div></div><!-- picture-in-picture  --><button id="movie-pip" class="pip__button" data-toggle="tooltip" title="picture-in-picture"><span class="px-4"><i id="movie-pip-ico" class="fas fa-window-maximize"></i></span></button><!-- theatre view  --><button class="theatre__button" data-toggle="tooltip" title="theatre mode"><span class="px-4"><i id="movie-th-ico" class="fas fa-arrows-alt-v"></i></span></button><!-- fullscreen  --><button id="movie-fs" class="fs__button" data-toggle="tooltip" title="fullscreen"><span class="px-4"><i id="movie-fs-ico" class="fas fa-expand"></i></span></button></div></div></div></div><!-- else this  --><!-- pay cost per video  --><div class="text-center text-muted text-white">pay $(number) to watch this video <button class="btn btn-primary btn-sm" type="button">Pay</button></div></div><!-- sidebar content  --><div class="col-xl-3 col-lg-6 col-md-5"><div style="background-color: white;color: black;" class="card comment"><div class="card-header"><h4>Comments</h4></div><div class="card-body"><ul id="movie-vid-comments"><li><div class="row media"><div class="col-xl-2 col-lg-2 col-md-2 col-sm-2"><!-- user-profile  --><img src="/img/img1.png" alt="" class="img-fluid"></div><!-- video-desccription  --><div class="col-xl-10 col-lg-10 col-md-10 col-sm-10"><div class="media-body px-1"><span class="font-weight-bold">S1 E1 - date</span><div class="d-cent text-justify">Lorem ipsum dolor sit amet consectetur adipisicing elit.Distinctio doloribus explicabo enim quae tenetur omnis, optiodolorem et. Eaque similique obcaecati laborum blanditiis officiis veniam maxime veritatis alias inventore voluptates!</div><button type="button" class="flg-comm-button px-2" data-toggle="modal" data-target="#flagCommentCenter"><i class="fas fa-flag"></i></button><button type="button" class="show-mr-button">show</button></div></div></div></li></ul></div></div></div></div></div>';

            $("#video_with_comments").empty();
            $("#video_with_comments").append(playerhtml);
            initialize_movie_player();

            set_content_display('block', 'none', 'block', 'block', 'none', 'block', 'none', 'none');

            var video = document.querySelector('#movie-video');
            var video_url = window.location.origin + '/video/' + video_id;
            var playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Automatic playback started!
                    // Show playing UI.
                })
                .catch(error => {
                    // Auto-play was prevented
                    // Show paused UI.
                });
            }
            $('#movie-insert-vid').attr('src', video_url);
            $('.progress__filled').css('flex', '0');

        }


        function play_free_movie(video_id) {

            var playerhtml = '<!-- video running section  --><div class="runner-section container-fluid"><div class="row"><!-- video-player  --><div class="col-xl-9 col-lg-8 col-md-7 player-wrapper"><!-- if paid  --><div class="player" id="movie-video-player"><!-- video-head  --><div class="video-head"><div class="text-white"><h3 class="font-weight-bold">movie name</h4></div></div><!-- video-body  --><div class="video-body"><video class="player__video viewer" id="movie-video" preload="metadata"><source src="" id="movie-insert-vid" type="video/mp4"></video></div><!-- video-footer  --><div class="video-footer"><div class="player__controls" id="movie-plact"><!-- progress-bar  --><div class="progress"><div class="progress__filled"></div></div><!-- play/pause  --><button class="player__button toggle" data-toggle="tooltip" title="pause"><i id="movie-play-icon" class="fas fa-play"></i></button><!-- skip 10s backword --><button data-skip="-10" class="backword__button" data-toggle="tooltip" title="Skip -10s">«10s</button><!-- skip 10s forward --><button data-skip="10" class="forward__button" data-toggle="tooltip" title="Skip 10s">10s»</button><!-- volume  --><button class="volume__button" data-toggle="tooltip" title="mute" id="movie-volume"><i id="movie-vol-ico" class="fas fa-volume-up"></i></button><input type="range" name="volume" id="movie-vol-ran" class="player__slider" min="0" max="1" step="0.05" value="1"><!-- video timer  --><button id="movie-progressTime" class="timer__button"><span id="movie-current">00:00 / </span><span id="movie-duration">00:00</span></button><!-- playbackrate  --><!-- <input type="range" name="playbackRate" class="player__slider" min="0.5" max="2" step="0.1" value="1"> --><div class="fullscreen"><!-- setting  --><!-- <button id="movie-setting" class="setting__button" data-toggle="tooltip" title="setting"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button> --><button type="button" class="prev-button mr-3"><i class="fas fa-step-backward"></i></button><button type="button" class="next-button"><i class="fas fa-step-forward"></i></button><div class="btn-group dropup"><button id="movie-setting" class="setting__button" data-toggle="dropdown" aria-haspopup="true"aria-expanded="false"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button><div class="dropdown-menu plbcrt"><a href="#" class="dropdown-item playbacki dis">Playback speed</a><a href="#" class="dropdown-item quali dis">Video Quality</a><a href="#" class="dropdown-item shortcuts dis">Keyboard shortcuts</a><a href="#" class="dropdown-item playback">0.25</a><a href="#" class="dropdown-item playback">0.5</a><a href="#" class="dropdown-item playback">1</a><a href="#" class="dropdown-item playback">1.25</a><a href="#" class="dropdown-item playback">1.5</a><a href="#" class="dropdown-item playback">1.75</a><a href="#" class="dropdown-item playback">2</a><a href="#" class="dropdown-item qual">Auto</a><a href="#" class="dropdown-item qual">480p</a><a href="#" class="dropdown-item qual">720p</a><a href="#" class="dropdown-item qual">1080p</a></div></div><!-- picture-in-picture  --><button id="movie-pip" class="pip__button" data-toggle="tooltip" title="picture-in-picture"><span class="px-4"><i id="movie-pip-ico" class="fas fa-window-maximize"></i></span></button><!-- theatre view  --><button class="theatre__button" data-toggle="tooltip" title="theatre mode"><span class="px-4"><i id="movie-th-ico" class="fas fa-arrows-alt-v"></i></span></button><!-- fullscreen  --><button id="movie-fs" class="fs__button" data-toggle="tooltip" title="fullscreen"><span class="px-4"><i id="movie-fs-ico" class="fas fa-expand"></i></span></button></div></div></div></div><!-- else this  --><!-- pay cost per video  --><div class="text-center text-muted text-white">pay $(number) to watch this video <button class="btn btn-primary btn-sm" type="button">Pay</button></div></div><!-- sidebar content  --><div class="col-xl-3 col-lg-6 col-md-5"><div style="background-color: white;color: black;" class="card comment"><div class="card-header"><h4>Comments</h4></div><div class="card-body"><ul id="movie-vid-comments"><li><div class="row media"><div class="col-xl-2 col-lg-2 col-md-2 col-sm-2"><!-- user-profile  --><img src="/img/img1.png" alt="" class="img-fluid"></div><!-- video-desccription  --><div class="col-xl-10 col-lg-10 col-md-10 col-sm-10"><div class="media-body px-1"><span class="font-weight-bold">S1 E1 - date</span><div class="d-cent text-justify">Lorem ipsum dolor sit amet consectetur adipisicing elit.Distinctio doloribus explicabo enim quae tenetur omnis, optiodolorem et. Eaque similique obcaecati laborum blanditiis officiis veniam maxime veritatis alias inventore voluptates!</div><button type="button" class="flg-comm-button px-2" data-toggle="modal" data-target="#flagCommentCenter"><i class="fas fa-flag"></i></button><button type="button" class="show-mr-button">show</button></div></div></div></li></ul></div></div></div></div></div>';

            $("#video_with_comments").empty();
            $("#video_with_comments").append(playerhtml);
            initialize_movie_player();

            set_content_display('block', 'none', 'none', 'none', 'none', 'none', 'none', 'block');

            var video = document.querySelector('#movie-video');
            var video_url = window.location.origin + '/video/' + video_id;
            // console.log(video_url);
            var playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Automatic playback started!
                    // Show playing UI.
                })
                .catch(error => {
                    // Auto-play was prevented
                    // Show paused UI.
                });
            }
            $('#movie-insert-vid').attr('src', video_url);
            $('.progress__filled').css('flex', '0');
        }


        function play_free_episode(video_id) {

            var playerhtml = '<!-- video running section  --><div class="runner-section container-fluid"><div class="row"><!-- video-player  --><div class="col-xl-9 col-lg-8 col-md-7 player-wrapper"><!-- if paid  --><div class="player" id="movie-video-player"><!-- video-head  --><div class="video-head"><div class="text-white"><h3 class="font-weight-bold">movie name</h4></div></div><!-- video-body  --><div class="video-body"><video class="player__video viewer" id="movie-video" preload="metadata"><source src="" id="movie-insert-vid" type="video/mp4"></video></div><!-- video-footer  --><div class="video-footer"><div class="player__controls" id="movie-plact"><!-- progress-bar  --><div class="progress"><div class="progress__filled"></div></div><!-- play/pause  --><button class="player__button toggle" data-toggle="tooltip" title="pause"><i id="movie-play-icon" class="fas fa-play"></i></button><!-- skip 10s backword --><button data-skip="-10" class="backword__button" data-toggle="tooltip" title="Skip -10s">«10s</button><!-- skip 10s forward --><button data-skip="10" class="forward__button" data-toggle="tooltip" title="Skip 10s">10s»</button><!-- volume  --><button class="volume__button" data-toggle="tooltip" title="mute" id="movie-volume"><i id="movie-vol-ico" class="fas fa-volume-up"></i></button><input type="range" name="volume" id="movie-vol-ran" class="player__slider" min="0" max="1" step="0.05" value="1"><!-- video timer  --><button id="movie-progressTime" class="timer__button"><span id="movie-current">00:00 / </span><span id="movie-duration">00:00</span></button><!-- playbackrate  --><!-- <input type="range" name="playbackRate" class="player__slider" min="0.5" max="2" step="0.1" value="1"> --><div class="fullscreen"><!-- setting  --><!-- <button id="movie-setting" class="setting__button" data-toggle="tooltip" title="setting"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button> --><button type="button" class="prev-button mr-3"><i class="fas fa-step-backward"></i></button><button type="button" class="next-button"><i class="fas fa-step-forward"></i></button><div class="btn-group dropup"><button id="movie-setting" class="setting__button" data-toggle="dropdown" aria-haspopup="true"aria-expanded="false"><span class="px-4"><i id="movie-setting-ico" class="fas fa-cog"></i></span></button><div class="dropdown-menu plbcrt"><a href="#" class="dropdown-item playbacki dis">Playback speed</a><a href="#" class="dropdown-item quali dis">Video Quality</a><a href="#" class="dropdown-item shortcuts dis">Keyboard shortcuts</a><a href="#" class="dropdown-item playback">0.25</a><a href="#" class="dropdown-item playback">0.5</a><a href="#" class="dropdown-item playback">1</a><a href="#" class="dropdown-item playback">1.25</a><a href="#" class="dropdown-item playback">1.5</a><a href="#" class="dropdown-item playback">1.75</a><a href="#" class="dropdown-item playback">2</a><a href="#" class="dropdown-item qual">Auto</a><a href="#" class="dropdown-item qual">480p</a><a href="#" class="dropdown-item qual">720p</a><a href="#" class="dropdown-item qual">1080p</a></div></div><!-- picture-in-picture  --><button id="movie-pip" class="pip__button" data-toggle="tooltip" title="picture-in-picture"><span class="px-4"><i id="movie-pip-ico" class="fas fa-window-maximize"></i></span></button><!-- theatre view  --><button class="theatre__button" data-toggle="tooltip" title="theatre mode"><span class="px-4"><i id="movie-th-ico" class="fas fa-arrows-alt-v"></i></span></button><!-- fullscreen  --><button id="movie-fs" class="fs__button" data-toggle="tooltip" title="fullscreen"><span class="px-4"><i id="movie-fs-ico" class="fas fa-expand"></i></span></button></div></div></div></div><!-- else this  --><!-- pay cost per video  --><div class="text-center text-muted text-white">pay $(number) to watch this video <button class="btn btn-primary btn-sm" type="button">Pay</button></div></div><!-- sidebar content  --><div class="col-xl-3 col-lg-6 col-md-5"><div style="background-color: white;color: black;" class="card comment"><div class="card-header"><h4>Comments</h4></div><div class="card-body"><ul id="movie-vid-comments"><li><div class="row media"><div class="col-xl-2 col-lg-2 col-md-2 col-sm-2"><!-- user-profile  --><img src="/img/img1.png" alt="" class="img-fluid"></div><!-- video-desccription  --><div class="col-xl-10 col-lg-10 col-md-10 col-sm-10"><div class="media-body px-1"><span class="font-weight-bold">S1 E1 - date</span><div class="d-cent text-justify">Lorem ipsum dolor sit amet consectetur adipisicing elit.Distinctio doloribus explicabo enim quae tenetur omnis, optiodolorem et. Eaque similique obcaecati laborum blanditiis officiis veniam maxime veritatis alias inventore voluptates!</div><button type="button" class="flg-comm-button px-2" data-toggle="modal" data-target="#flagCommentCenter"><i class="fas fa-flag"></i></button><button type="button" class="show-mr-button">show</button></div></div></div></li></ul></div></div></div></div></div>';

            // $('#selected_movie_description').empty();
            // $('#selected_movie_description').css('display', 'block');
            $("#video_with_comments").empty();
            $("#video_with_comments").append(playerhtml);
            initialize_movie_player();

            // $('#video_with_comments').css('display', 'block');

            set_content_display('block', 'none', 'block', 'block', 'none', 'block', 'none', 'none');

            var video = document.querySelector('#movie-video');
            var video_url = window.location.origin + '/video/' + video_id;
            // console.log(video_url);
            var playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Automatic playback started!
                    // Show playing UI.
                })
                .catch(error => {
                    // Auto-play was prevented
                    // Show paused UI.
                });
            }
            $('#movie-insert-vid').attr('src', video_url);
            $('.progress__filled').css('flex', '0');

        }


        //got the rating ajax call to save it in the database
        $('#movierate-submit').on('click', function (e) {
            var movie_id = document.getElementById('selected_movie_id').innerHTML;

             // javascript data object
             var data = {
                'movie_id': movie_id,
                'movie_rating':  movierating,
            }

            // adding data to javascript form which is to be send over ajax request
            var formData = new FormData();
            formData.append('data', JSON.stringify(data));

            $.ajax({
                type: 'POST',
                url: '{% url "rate_movie" %}',
                data: formData,
                dataType: 'json',
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                success: function (data) {
                    // checking and handling error conditions
                    if (data.is_movie_exists != '') {
                        alert(data.is_movie_exists);
                    } else if (data.is_user_logged_in != '') {
                        alert(data.is_user_logged_in);
                    } else if (data.is_successful != '') {
                        $('#movierateCenter').modal('hide');
                        alert(data.is_successful);
                    } else {
                        alert('Some unexpected error has occured. Try again.');
                    }
                }
            });

        })

         //got the rating ajax call to save it in the database
        $('#seriesrate-submit').on('click', function (e) {
            var series_id = document.getElementById('selected_series_id').innerHTML;

             // javascript data object
             var data = {
                'series_id': series_id,
                'series_rating':  seriesrating,
            }

            // adding data to javascript form which is to be send over ajax request
            var formData = new FormData();
            formData.append('data', JSON.stringify(data));

            $.ajax({
                type: 'POST',
                url: '{% url "rate_series" %}',
                data: formData,
                dataType: 'json',
                enctype: 'multipart/form-data',
                processData: false,
                contentType: false,
                success: function (data) {
                    // checking and handling error conditions
                    if (data.is_series_exists != '') {
                        alert(data.is_series_exists);
                    } else if (data.is_user_logged_in != '') {
                        alert(data.is_user_logged_in);
                    } else if (data.is_successful != '') {
                        $('#seriesrateCenter').modal('hide');
                        alert(data.is_successful);
                    } else {
                        alert('Some unexpected error has occured. Try again.');
                    }
                }
            });
        })


    </script>
</body>

</html>